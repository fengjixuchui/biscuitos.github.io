---
layout: post
title:  "å†…æ ¸æ ¸å¿ƒè½¬å‚¨: Kdump with kexec and crash"
date:   2021-06-01 06:00:00 +0800
categories: [HW]
excerpt: MMU Tools.
tags:
  - Tools
---

![](https://gitee.com/BiscuitOS_team/PictureSet/raw/Gitee/BiscuitOS/kernel/IND00000L0.PNG)

![](https://gitee.com/BiscuitOS_team/PictureSet/raw/Gitee/RPI/RPI100100.png)

#### ç›®å½•

> - [å†…æ ¸æ ¸å¿ƒè½¬å‚¨ä»‹ç»](#A)
>
> - [å†…æ ¸æ ¸å¿ƒè½¬å‚¨ç¯å¢ƒéƒ¨ç½²](#B)
>
> - [Crash åŸºç¡€æ•™ç¨‹](#E)
>
> - [Crash ç»å…¸æ¡ˆä¾‹ä¹‹](#D)
>
>   - [Crash ç»å…¸æ¡ˆä¾‹å€¼å†…å­˜è¶Šç•Œ](#D0)
>
>   - [Crash ç»å…¸æ¡ˆä¾‹ä¹‹ç©ºæŒ‡é’ˆ](#D1)
>
> - [ç•™è¨€ä¸é—®é¢˜åé¦ˆ](#ANS)
>
> - [é™„å½•/æèµ ](#Z0)

![](https://gitee.com/BiscuitOS_team/PictureSet/raw/Gitee/BiscuitOS/kernel/IND000100.png)

----------------------------------

<span id="B"></span>

![](https://gitee.com/BiscuitOS_team/PictureSet/raw/Gitee/BiscuitOS/kernel/IND00000H.jpg)

#### å†…æ ¸æ ¸å¿ƒè½¬å‚¨ç¯å¢ƒéƒ¨ç½²

å†…æ ¸æ ¸å¿ƒè½¬å‚¨ç¯å¢ƒéƒ¨ç½²æŒ‡çš„æ˜¯å½“å†…æ ¸å‘ç”Ÿ panic æ—¶ï¼Œå¯ä»¥å€ŸåŠ©ä¸€å®šçš„å·¥å…·è·å¾—å†…æ ¸æ ¸å¿ƒè½¬å‚¨çš„å†…å®¹ï¼Œä¸ºåæœŸçš„é—®é¢˜æ’é™¤ä¿ç•™äº†é—®é¢˜ç°åœºå’Œé—®é¢˜æ•°æ®ï¼Œè¿™é‡Œç®€å•çš„ç§°ä¸º kdump ä¸ºå†…æ ¸æ ¸å¿ƒè½¬å‚¨ã€‚å†…æ ¸å’Œå„å‘è¡Œç‰ˆéƒ½æä¾›äº†å¤šç§æŠ“å–å†…æ ¸ kdump çš„å·¥å…·å’Œæ–¹æ³•ï¼Œå…¶ä¸­åŒ…å«äº†éå‘è¡Œç‰ˆçš„ "kexec+crash" æ–¹æ¡ˆï¼Œè¯¥æ–¹æ¡ˆå¯ä»¥è¿ç”¨äºçº¢å¸½å’Œ Ubuntu ç­‰å‘è¡Œç‰ˆï¼Œä¹Ÿå¯ä»¥ç”¨äºéæ ‡å‡†å‘è¡Œç‰ˆçš„ Linux ç³»ç»Ÿä¹‹ä¸Šï¼Œé‚£ä¹ˆè¿™é‡Œå°±ä»¥ "kexec+crash" æ–¹æ¡ˆè¿›è¡Œè®²è§£ã€‚ä¸ºäº†è®©å¼€å‘è€…æ›´å¥½çš„å®è·µï¼Œæœ¬æ–‡æä¾›äº†å¤šç§è§£å†³æ–¹æ¡ˆï¼Œå»ºè®®å¼€å‘è€…ä½¿ç”¨ BiscuitOS æ–¹æ¡ˆè¿›è¡Œå®è·µ. æœ¬æ–‡ä»¥ Linux 5.0 X86_64 å†…æ ¸è¿›è¡Œå®è·µè®²è§£, å…·ä½“å¦‚ä¸‹:

> [é€šç”¨å†…æ ¸æ–¹æ¡ˆ](#B80)
>
> - [å†…æ ¸è½¬å‚¨ Kdump å†…æ ¸é…ç½®](#B00)
>
> - [å†…æ ¸è½¬å‚¨ Kdump CMDLINE é…ç½®](#B01)
>
> - [kexec-tools å·¥å…·å®‰è£…ä½¿ç”¨](#B03)
>
> - [å†…æ ¸è½¬å‚¨ Kdump æŠ“æ•è¿‡ç¨‹](#C0)
>
> - [Documentation for Kdump - The kexec-based Crash Dumping Solution](https://www.kernel.org/doc/html/latest/admin-guide/kdump/kdump.html)
>
> [æ ‡å‡†å‘è¡Œç‰ˆæ–¹æ¡ˆ (RedHat/Ubuntu)](#B82)
>
> - [Crash å†…æ ¸é…ç½®](#B00)
>
> - [CRUB CMDLINE é…ç½®](#B06)
>
> - [Crash å·¥å…·åŒ…å®‰è£…](#B05)
>
> [BiscuitOS æ–¹æ¡ˆ (æ¨è)](#B81)
>
> - [BiscuitOS å†…æ ¸è½¬å‚¨ Kdump å†…æ ¸é…ç½®](#BX0)
>
> - [BiscuitOS å†…æ ¸è½¬å‚¨ CMDLINE é…ç½®](#B02)
>
> - [BiscuitOS kexec-tools éƒ¨ç½²](#B04)
>
> - [BiscuitOS å†…æ ¸è½¬å‚¨ kdump æŠ“æ•è¿‡ç¨‹](#C1)
>
> - [åŸºäº Linux 5.0 X86_64 æ¶æ„çš„ BiscuitOS ç¯å¢ƒéƒ¨ç½²æ•™ç¨‹](https://biscuitos.github.io/blog/Linux-5.0-x86_64-Usermanual/)

![](https://gitee.com/BiscuitOS_team/PictureSet/raw/Gitee/BiscuitOS/kernel/IND000100.png)

----------------------------------

<span id="B80"></span>

![](https://gitee.com/BiscuitOS_team/PictureSet/raw/Gitee/BiscuitOS/kernel/IND00000I.jpg)

#### é€šç”¨æ–¹æ¡ˆ

é€šç”¨æ–¹æ¡ˆæŒ‡çš„æ˜¯å¤§å¤šæ•° Linux ç³»ç»Ÿä¸Šéƒ½å¯ä»¥ä½¿ç”¨çš„æŠ“å– kdump æ–¹æ¡ˆã€‚è¯¥æ–¹æ¡ˆçš„ä¸»è¦æ€è·¯å°±æ˜¯å½“å†…æ ¸å‘ç”Ÿ panic çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨ kexec å¿«é€Ÿé‡å¯ä¸€ä¸ªæ–°çš„å†…æ ¸ï¼Œä»¥æ­¤ç»™ç»´æŠ¤äººå‘˜åˆ›é€ ä¸€ä¸ªä¿ç•™é—®é¢˜ç°åœºçš„æœºä¼šï¼Œåœ¨è¿›å…¥æ–°ç³»ç»Ÿä¹‹åç»´æŠ¤äººå‘˜å¯ä»¥å°†å†…æ ¸ kdump å†…å®¹ä¿å­˜åœ¨æŒ‡å®šä½ç½®ï¼Œä»¥æ­¤ç”±äºåæœŸé—®é¢˜çš„æ’é™¤ã€‚ä¸ºäº†å®ç°ä¸Šé¢çš„åŠŸèƒ½ï¼Œéœ€è¦æ‰“å¼€å†…æ ¸æŸäº›åŠŸèƒ½ï¼Œå¹¶ä¸º kexec æä¾›ä¸€ä¸ªå¯ä»¥å¿«é€Ÿé‡å¯çš„å†…æ ¸ï¼Œæœ€åå°±æ˜¯ä½¿ç”¨ crash ç­‰å·¥å…·è¿›è¡Œé—®é¢˜æ’é™¤, é‚£ä¹ˆå¼€å‘è€…æ¥ä¸‹æ¥å‚è€ƒä¸‹é¢çš„å†…å®¹è¿›è¡Œéƒ¨ç½²å®è·µ:

> - [å†…æ ¸è½¬å‚¨ Kdump å†…æ ¸é…ç½®](#B00)
>
> - [å†…æ ¸è½¬å‚¨ Kdump CMDLINE é…ç½®](#B01)
>
> - [kexec-tools å·¥å…·å®‰è£…ä½¿ç”¨](#B03)
>
> - [å†…æ ¸è½¬å‚¨ Kdump æŠ“æ•è¿‡ç¨‹](#C0)
>
> - [Documentation for Kdump - The kexec-based Crash Dumping Solution](https://www.kernel.org/doc/html/latest/admin-guide/kdump/kdump.html)

![](https://gitee.com/BiscuitOS_team/PictureSet/raw/Gitee/BiscuitOS/kernel/IND000100.png)

------------------------------------------

###### <span id="B00">å†…æ ¸è½¬å‚¨ Kdump å†…æ ¸é…ç½®</span>

å†…æ ¸ä¸ºäº†æ”¯æŒ kdump åŠŸèƒ½ï¼Œéœ€è¦æ‰“å¼€ä»¥ä¸‹å®ï¼Œä»¥åŠä¸åŒçš„æ¶æ„æ‰“å¼€çš„å®ä¸åŒ:

###### CONFIG_KEXEC

![](https://gitee.com/BiscuitOS_team/PictureSet/raw/Gitee/HK/TH000630.png)

###### CONFIG_SYSFS

![](https://gitee.com/BiscuitOS_team/PictureSet/raw/Gitee/HK/TH000631.png)

###### CONFIG_DEBUG_INFO

![](https://gitee.com/BiscuitOS_team/PictureSet/raw/Gitee/HK/TH000632.png)

###### CONFIG_CRASH_DUMP

![](https://gitee.com/BiscuitOS_team/PictureSet/raw/Gitee/HK/TH000633.png)

###### CONFIG_PROC_VMCORE

![](https://gitee.com/BiscuitOS_team/PictureSet/raw/Gitee/HK/TH000634.png)

![](https://gitee.com/BiscuitOS_team/PictureSet/raw/Gitee/BiscuitOS/kernel/IND000100.png)

------------------------------------------

###### <span id="B01">å†…æ ¸è½¬å‚¨ Kdump CMDLINE é…ç½®</span>

å†…æ ¸å¯ç”¨ç›¸å…³çš„å†…æ ¸é…ç½®ä¹‹åï¼Œé‡æ–°ç¼–è¯‘å†…æ ¸ä¹‹åéœ€è¦åœ¨ CMDLINE ä¸­é…ç½® crash å†…æ ¸å ç”¨çš„å†…å­˜å¤§å°ï¼Œå…¶è¯­æ³•å¦‚ä¸‹:

{% highlight bash %}
crashkernel=<range1>:<size1>[,<range2>:<size2>,...][@offset]
range=start-[end]
{% endhighlight %}

é€šå¸¸å¯ä»¥åœ¨å†…æ ¸çš„ CMDLINE ä¸­æ·»åŠ å¦‚ä¸‹å‚æ•°:

{% highlight bash %}
crashkernel=128M
{% endhighlight %}

CMDLINE ä¸­è¯¥å­—æ®µç”¨äºç³»ç»Ÿå¯åŠ¨æ—¶ä¸º kdump é¢„ç•™ 128Mã€‚

![](https://gitee.com/BiscuitOS_team/PictureSet/raw/Gitee/BiscuitOS/kernel/IND000100.png)

---------------------------------

###### <span id="B03">kexec-tools å·¥å…·å®‰è£…ä½¿ç”¨</span>

åœ¨è°ƒè¯•è¿‡ç¨‹ä¸­ï¼Œç»å¸¸éœ€è¦é‡å¯å†…æ ¸ä»¥è¿˜åŸç°åœºï¼Œè¿›è€Œå¤ç°æŸäº›é—®é¢˜äºˆä»¥è¿½è¸ªè§£å†³. ç”±äºæ¯ä¸€æ¬¡çš„å†…æ ¸å¯åŠ¨ï¼Œéƒ½ä¼šä¼´éšç€ä¸€æ¬¡çš„ boot è‡ªæ£€. ä½†æ˜¯ï¼Œå¯¹äºå·²ç»å¯åŠ¨è¿‡çš„åŒä¸€å†…æ ¸ï¼Œé‡å¤çš„ boot è‡ªæ£€å®Œå…¨æ²¡æœ‰å¿…è¦ï¼Œä¸”é€ æˆäº†èµ„æºæµªè´¹. æ­¤å¤–ï¼Œæœ‰æ—¶å€™éœ€è¦ä½¿ç”¨ä¸€ä¸ªå°å†…æ ¸æ¥å¯åŠ¨ä¸€ä¸ªå¤§å†…æ ¸. åœ¨è¿™ä¸¤ç§éœ€æ±‚ä¸‹ï¼Œkexec åº”è¿è€Œç”Ÿï¼Œkexec æ˜¯ä¸€æ¬¾å¯ä»¥è®©æ‚¨é‡æ–°å¯åŠ¨åˆ°ä¸€ä¸ªæ–° Linux å†…æ ¸çš„å¿«é€Ÿé‡æ–°å¼•å¯¼åŠŸèƒ½éƒ¨ä»¶ï¼Œä¸å†å¿…é¡»é€šè¿‡å›ºä»¶å’Œå¼•å¯¼è£…è½½ç¨‹åºé˜¶æ®µï¼Œä»è€Œè·³è¿‡åºåˆ—ä¸­æœ€é•¿çš„éƒ¨åˆ†ï¼Œå¤§å¤§å‡å°‘äº†é‡å¯æ—¶é—´. å¯¹ä¼ä¸šçº§ç³»ç»Ÿè€Œè¨€ï¼ŒKexec å¤§å¤§å‡å°‘äº†é‡å¯å¼•èµ·çš„ç³»ç»Ÿå®•æœºæ—¶é—´. å¯¹å†…æ ¸å’Œç³»ç»Ÿè½¯ä»¶å¼€å‘è€…è€Œè¨€ï¼ŒKexec å¸®åŠ©æ‚¨åœ¨å¼€å‘å’Œæµ‹è¯•æˆæœæ—¶å¯ä»¥è¿…é€Ÿé‡æ–°å¯åŠ¨ç³»ç»Ÿï¼Œè€Œä¸å¿…æ¯æ¬¡éƒ½è¦å†ç»å†è€—æ—¶çš„å›ºä»¶é˜¶æ®µ. é€šç”¨ linux ç³»ç»Ÿä¸­å¯ç”¨é€šè¿‡æºç ç¼–è¯‘çš„æ–¹å¼å®‰è£… kexec-tools å·¥å…·ï¼Œå¼€å‘è€…å¯ä»¥å‚è€ƒå¦‚ä¸‹æ­¥éª¤:

###### æºç ä¸‹è½½

{% highlight bash %}
wget http://kernel.org/pub/linux/utils/kernel/kexec/kexec-tools.tar.gz
{% endhighlight %}

###### æºç è§£å‹

{% highlight bash %}
tar xf kexec-tools.tar.gz
{% endhighlight %}

###### é…ç½®ç¼–è¯‘

{% highlight bash %}
cd kexec-tools-VERSION
./configure
make
make install
{% endhighlight %}

![](https://gitee.com/BiscuitOS_team/PictureSet/raw/Gitee/BiscuitOS/kernel/IND000100.png)

-------------------------------------

###### <span id="C0">å†…æ ¸è½¬å‚¨ Kdump æŠ“æ•è¿‡ç¨‹</span>

åœ¨é€šç”¨å†…æ ¸ä¸­ï¼Œå½“å‘ç”Ÿå†…æ ¸ kdump æ—¶å¯ä»¥ä½¿ç”¨ kexec-tools é‡æ–°å¯åŠ¨åˆ°ä¸€ä¸ªæ–° Linux å†…æ ¸ï¼Œç»´æŠ¤è€…å¯ä»¥åˆ©ç”¨é‡å¯çš„æ–°å†…æ ¸ä¿å­˜ kdump å†…å®¹. ä¸ºäº† kexec èƒ½å¤Ÿå¿«é€Ÿé‡å¯å†…æ ¸ï¼Œå› æ­¤éœ€è¦å‡†å¤‡ä¸€ä¸ª Dump-capture Kernel, Dump-capture Kernel åœ¨ä¸åŒçš„æ¶æ„ä¸­è¡¨ç¤ºä¸åŒï¼Œä¾‹å¦‚åœ¨ i386 æˆ–è€… x86_64 ä¸­ï¼Œå¯ä»¥æ˜¯ vmlinux æˆ–è€… bzImage/vmlinuxz; ä¾‹å¦‚åœ¨ arm æ¶æ„ä¸­å¯ä»¥æ˜¯ zImage, è€Œåœ¨ ARM64 æ¶æ„ä¸­ä¸º vmlinux/Image. å› æ­¤åœ¨é€šç”¨å†…æ ¸ä¸­ï¼Œå¯ä»¥å‚ç…§å¦‚ä¸‹å‘½ä»¤åœ¨ç³»ç»Ÿå¯åŠ¨å®Œæ¯•ä¹‹åè¿è¡Œ kexec å·¥å…·:

{% highlight bash %}
kexec -p <Dump-capture-kernel> --initrd=<initrd-for-Dump-capture-kernel> \
      --append=<CMDLINE>
{% endhighlight %}

å½“åœ¨ç³»ç»Ÿä¸­æˆåŠŸè¿è¡Œ kexec ä¸­ï¼Œæ¥ç€å¯ä»¥æ‰‹åŠ¨è§¦å‘å†…æ ¸ panicï¼Œä»¥æ­¤æŸ¥çœ‹åŠŸèƒ½çš„å®Œæˆæ€§:

{% highlight bash %}
echo c > /proc/sysrq-trigger
{% endhighlight %}

å½“ä½¿ç”¨è¯¥å‘½ä»¤ä¹‹åï¼Œå†…æ ¸å°†è§¦å‘ panicï¼Œæ­£å¸¸æƒ…å†µä¸‹å†…æ ¸å°†å¡ä¸»ä¸è¿è¡Œï¼Œå½“æ­¤æ—¶ kexec ä¼šè¿…é€Ÿé‡å¯ä¸€ä¸ªæ–°çš„å†…æ ¸ï¼Œå¹¶ä¿æŠ¤äº†å‘ç”Ÿ panic çš„ç°åœºï¼Œå³å†…æ ¸çš„ kdumpã€‚åœ¨è¿›å…¥æ–°ç³»ç»Ÿä¹‹åï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤è·å¾—å‘ç”Ÿ panic æ—¶çš„ vmcore:

{% highlight bash %}
cp /proc/vmcore <Dump-file>
{% endhighlight %}

"/proc/vmcore" åŒ…å«äº† kdump çš„å†…å®¹ï¼Œå¯ä»¥å°† kdump çš„å†…å®¹æ‹·è´åˆ°ä¸€ä¸ªå®‰å…¨çš„åœ°æ–¹ï¼Œä»¥ä¾¿åæœŸä½¿ç”¨ crash è¿›è¡Œé—®é¢˜åˆ†ææ’é™¤ã€‚å½“ kdump å†…å®¹æ‹·è´å®Œæ¯•ä¹‹åï¼Œæ¥ä¸‹æ¥å°±æ˜¯ä½¿ç”¨ crash æ’é™¤é—®é¢˜ï¼Œå‚è€ƒå¦‚ä¸‹å‘½ä»¤:

{% highlight bash %}
crash <Dump-file> vmlinux
{% endhighlight %}

å¦‚ä¸Šå‘½ä»¤ï¼Œ"Dump-file" å°±æ˜¯ä»é—®é¢˜æœºå™¨ä¸Šä¿ç•™çš„ kdump æ–‡ä»¶ï¼Œè€Œ vmlinux åˆ™æ˜¯å¸¦æœ‰ debug-info çš„å†…æ ¸é•œåƒ. æ¥ä¸‹æ¥ Crash è°ƒè¯•æ–¹æ³•å¯ä»¥å‚è€ƒ Crash ä½¿ç”¨ç« èŠ‚.

![](https://gitee.com/BiscuitOS_team/PictureSet/raw/Gitee/BiscuitOS/kernel/IND000100.png)

------------------------------------------

<span id="B81"></span>

![](https://gitee.com/BiscuitOS_team/PictureSet/raw/Gitee/BiscuitOS/kernel/IND00000G.jpg)

#### BiscuitOS æ–¹æ¡ˆ

BiscuitOS æ–¹æ¡ˆæŒ‡çš„æ˜¯åŸºäº BiscuitOS æ„å»ºçš„å†…æ ¸ kdump æŠ“å–æ–¹æ¡ˆã€‚è¯¥æ–¹æ¡ˆçš„ä¸»è¦æ€è·¯ä¸åŒæ ·æ–¹æ¡ˆä¸€è‡´ï¼Œä¸åŒç‚¹åœ¨äºä½¿ç”¨ BiscuitOS å¿«é€Ÿéƒ¨ç½²æ‰€éœ€çš„å·¥å…·å’Œå¼€å‘ç¯å¢ƒã€‚åœ¨è¯¥æ–¹æ¡ˆä¸­å½“å†…æ ¸å‘ç”Ÿ panic çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨ kexec å¿«é€Ÿé‡å¯ä¸€ä¸ªæ–°çš„å†…æ ¸ï¼Œä»¥æ­¤ç»™ç»´æŠ¤äººå‘˜åˆ›é€ ä¸€ä¸ªä¿ç•™é—®é¢˜ç°åœºçš„æœºä¼šï¼Œåœ¨è¿›å…¥æ–°ç³»ç»Ÿä¹‹åç»´æŠ¤äººå‘˜å¯ä»¥å°†å†…æ ¸ kdump å†…å®¹ä¿å­˜åœ¨æŒ‡å®šä½ç½®ï¼Œä»¥æ­¤ç”±äºåæœŸé—®é¢˜çš„æ’é™¤ã€‚ä¸ºäº†å®ç°ä¸Šé¢çš„åŠŸèƒ½ï¼Œéœ€è¦æ‰“å¼€å†…æ ¸æŸäº›åŠŸèƒ½ï¼Œå¹¶ä¸º kexec æä¾›ä¸€ä¸ªå¯ä»¥å¿«é€Ÿé‡å¯çš„å†…æ ¸ï¼Œæœ€åå°±æ˜¯ä½¿ç”¨ crash ç­‰å·¥å…·è¿›è¡Œé—®é¢˜æ’é™¤ã€‚ç”±äºè¯¥å®è·µåŸºäº BiscuitOS linux 5.0 X86_64 æ¶æ„ï¼Œæ²¡æœ‰æ­å»ºè¯¥ç¯å¢ƒçš„å¼€å‘è€…å¯ä»¥å…ˆæ­å»ºç¯å¢ƒå†å®è·µã€‚é‚£ä¹ˆå¼€å‘è€…æ¥ä¸‹æ¥å‚è€ƒä¸‹é¢çš„å†…å®¹è¿›è¡Œéƒ¨ç½²å®è·µ:

> - [BiscuitOS å†…æ ¸è½¬å‚¨ Kdump å†…æ ¸é…ç½®](#BX0)
>
> - [BiscuitOS å†…æ ¸è½¬å‚¨ CMDLINE é…ç½®](#B02)
>
> - [BiscuitOS kexec-tools éƒ¨ç½²](#B04)
>
> - [BiscuitOS å†…æ ¸è½¬å‚¨ kdump æŠ“æ•è¿‡ç¨‹](#C1)
>
> - [åŸºäº Linux 5.0 X86_64 æ¶æ„çš„ BiscuitOS ç¯å¢ƒéƒ¨ç½²æ•™ç¨‹](https://biscuitos.github.io/blog/Linux-5.0-x86_64-Usermanual/)

![](https://gitee.com/BiscuitOS_team/PictureSet/raw/Gitee/BiscuitOS/kernel/IND000100.png)

------------------------------------------

###### <span id="BX0">BiscuitOS å†…æ ¸è½¬å‚¨ Kdump å†…æ ¸é…ç½®</span>

å†…æ ¸ä¸ºäº†æ”¯æŒ kdump åŠŸèƒ½ï¼Œéœ€è¦æ‰“å¼€ä»¥ä¸‹å®ï¼Œä»¥åŠä¸åŒçš„æ¶æ„æ‰“å¼€çš„å®ä¸åŒ:

###### CONFIG_KEXEC

![](https://gitee.com/BiscuitOS_team/PictureSet/raw/Gitee/HK/TH000630.png)

###### CONFIG_SYSFS

![](https://gitee.com/BiscuitOS_team/PictureSet/raw/Gitee/HK/TH000631.png)

###### CONFIG_DEBUG_INFO

![](https://gitee.com/BiscuitOS_team/PictureSet/raw/Gitee/HK/TH000632.png)

###### CONFIG_CRASH_DUMP

![](https://gitee.com/BiscuitOS_team/PictureSet/raw/Gitee/HK/TH000633.png)

###### CONFIG_PROC_VMCORE

![](https://gitee.com/BiscuitOS_team/PictureSet/raw/Gitee/HK/TH000634.png)

![](https://gitee.com/BiscuitOS_team/PictureSet/raw/Gitee/BiscuitOS/kernel/IND000100.png)

------------------------------------------

#### <span id="B02">BiscuitOS å†…æ ¸è½¬å‚¨ CMDLINE é…ç½®</span>

å†…æ ¸å¯ç”¨ç›¸å…³çš„å†…æ ¸é…ç½®ä¹‹åï¼Œé‡æ–°ç¼–è¯‘å†…æ ¸ä¹‹åéœ€è¦åœ¨å†…æ ¸çš„ CMDLINE ä¸­æ·»åŠ  crash å ç”¨çš„å†…å­˜å¤§å°ï¼Œå…¶è¯­æ³•å¦‚ä¸‹:

{% highlight bash %}
crashkernel=<range1>:<size1>[,<range2>:<size2>,...][@offset]
range=start-[end]
{% endhighlight %}

BiscuitOS ä¸­å†…æ ¸çš„ CMDLINE ä½äºé¡¹ç›®ç›®å½•ä¸‹çš„ RunBiscuitOS.sh è„šæœ¬ä¸­ï¼Œå…¶ä¸­ CMDLINE å˜é‡ä¸­ï¼Œå¯ä»¥å‚è€ƒå¦‚ä¸‹è¿›è¡Œæ·»åŠ :

{% highlight bash %}
cd BiscuitOS/output/linux-XXX/
vi RunBiscuitOS.sh

CMDLINE="root=/dev/sda rw rootfstype=${FS_TYPE} console=ttyS0 init=/linuxrc loglevel=8 crashkernel=128M nr_cpus=2"
{% endhighlight %}

å¦‚ä¸Šåœ¨ CMDLINE å˜é‡ä¸­æ·»åŠ äº† "crashkernel=128M nr_cpus" å­—æ®µï¼Œå¯ä»¥è®©å†…æ ¸ä¸º kdump é¢„ç•™çš„å†…å­˜å¤§å°ä¸º 128Mã€‚

![](https://gitee.com/BiscuitOS_team/PictureSet/raw/Gitee/HK/TH000638.png)

![](https://gitee.com/BiscuitOS_team/PictureSet/raw/Gitee/BiscuitOS/kernel/IND000100.png)

------------------------------------------

#### <span id="B04">BiscuitOS kexec-tools éƒ¨ç½²</span>

åœ¨è°ƒè¯•è¿‡ç¨‹ä¸­ï¼Œç»å¸¸éœ€è¦é‡å¯å†…æ ¸ä»¥è¿˜åŸç°åœºï¼Œè¿›è€Œå¤ç°æŸäº›é—®é¢˜äºˆä»¥è¿½è¸ªè§£å†³. ç”±äºæ¯ä¸€
æ¬¡çš„å†…æ ¸å¯åŠ¨ï¼Œéƒ½ä¼šä¼´éšç€ä¸€æ¬¡çš„ boot è‡ªæ£€. ä½†æ˜¯ï¼Œå¯¹äºå·²ç»å¯åŠ¨è¿‡çš„åŒä¸€å†…æ ¸ï¼Œé‡å¤çš„
 boot è‡ªæ£€å®Œå…¨æ²¡æœ‰å¿…è¦ï¼Œä¸”é€ æˆäº†èµ„æºæµªè´¹. æ­¤å¤–ï¼Œæœ‰æ—¶å€™éœ€è¦ä½¿ç”¨ä¸€ä¸ªå°å†…æ ¸æ¥å¯åŠ¨ä¸€
ä¸ªå¤§å†…æ ¸. åœ¨è¿™ä¸¤ç§éœ€æ±‚ä¸‹ï¼Œkexec åº”è¿è€Œç”Ÿï¼Œkexec æ˜¯ä¸€æ¬¾å¯ä»¥è®©æ‚¨é‡æ–°å¯åŠ¨åˆ°ä¸€ä¸ªæ–° Linux å†…æ ¸çš„å¿«é€Ÿé‡æ–°å¼•å¯¼åŠŸèƒ½éƒ¨ä»¶ï¼Œä¸å†å¿…é¡»é€šè¿‡å›ºä»¶å’Œå¼•å¯¼è£…è½½ç¨‹åºé˜¶æ®µï¼Œä»è€Œè·³è¿‡åº>åˆ—ä¸­æœ€é•¿çš„éƒ¨åˆ†ï¼Œå¤§å¤§å‡å°‘äº†é‡å¯æ—¶é—´. å¯¹ä¼ä¸šçº§ç³»ç»Ÿè€Œè¨€ï¼ŒKexec å¤§å¤§å‡å°‘äº†é‡å¯å¼•èµ·çš„
ç³»ç»Ÿå®•æœºæ—¶é—´. å¯¹å†…æ ¸å’Œç³»ç»Ÿè½¯ä»¶å¼€å‘è€…è€Œè¨€ï¼ŒKexec å¸®åŠ©æ‚¨åœ¨å¼€å‘å’Œæµ‹è¯•æˆæœæ—¶å¯ä»¥è¿…é€Ÿ
é‡æ–°å¯åŠ¨ç³»ç»Ÿï¼Œè€Œä¸å¿…æ¯æ¬¡éƒ½è¦å†ç»å†è€—æ—¶çš„å›ºä»¶é˜¶æ®µ. BiscuitOS å·²ç»æ”¯æŒ kexec-tools çš„è‡ªåŠ¨éƒ¨ç½²ï¼Œå¼€å‘è€…å¯ä»¥å‚è€ƒå¦‚ä¸‹å‘½ä»¤:

###### æºç éƒ¨ç½²

{% highlight bash %}
cd BiscuitOS
make menuconfig

  [*] Package  --->
      [*] kexec-tools  --->

BiscuitOS/output/linux-XXXX/package/kexec-tools-2.0.22
{% endhighlight %}

###### æºç ä¸‹è½½è§£å‹

{% highlight bash %}
cd BiscuitOS/output/linux-XXXX/package/kexec-tools-2.0.22
make download
make tar
{% endhighlight %}

###### æºç é…ç½®ç¼–è¯‘å®‰è£…

{% highlight bash %}
cd BiscuitOS/output/linux-XXXX/package/kexec-tools-2.0.22
make configure
make
make install
make pack
{% endhighlight %}

![](https://gitee.com/BiscuitOS_team/PictureSet/raw/Gitee/HK/TH000635.png)

![](https://gitee.com/BiscuitOS_team/PictureSet/raw/Gitee/BiscuitOS/kernel/IND000100.png)

------------------------------------------

###### <span id="C1">BiscuitOS å†…æ ¸è½¬å‚¨ kdump æŠ“æ•è¿‡ç¨‹</span>

åœ¨ BiscuitOS ä¸­ï¼Œå½“å‘ç”Ÿå†…æ ¸ kdump æ—¶å¯ä»¥ä½¿ç”¨ kexec-tools é‡æ–°å¯åŠ¨åˆ°ä¸€ä¸ªæ–° Linux å†…æ ¸ï¼Œç»´æŠ¤è€…å¯ä»¥åˆ©ç”¨é‡å¯çš„æ–°å†…æ ¸ä¿å­˜ kdump å†…å®¹. ä¸ºäº† kexec èƒ½å¤Ÿå¿«é€Ÿé‡å¯å†…æ ¸ï¼Œå› æ­¤éœ€è¦å‡†å¤‡ä¸€ä¸ª Dump-capture Kernel, Dump-capture Kernel åœ¨ä¸åŒçš„æ¶æ„ä¸­è¡¨ç¤ºä¸åŒï¼Œä¾‹å¦‚åœ¨ i386 æˆ–è€… x86_64 ä¸­ï¼Œå¯ä»¥æ˜¯ vmlinux æˆ–è€… bzImage/vmlinuxz; ä¾‹å¦‚åœ¨ arm æ¶æ„ä¸­å¯ä»¥æ˜¯ zImage, è€Œåœ¨ ARM64 æ¶æ„ä¸­ä¸º vmlinux/Image. BiscuitOS ä¼šæ ¹æ®ä¸åŒçš„æ¶æ„è‡ªåŠ¨å‡†å¤‡è¯¥å†…æ ¸ã€‚å› æ­¤åœ¨ BiscuitOS ä¸­ï¼Œå¯ä»¥å‚ç…§å¦‚ä¸‹å‘½ä»¤åœ¨ç³»ç»Ÿå¯åŠ¨å®Œæ¯•ä¹‹åè¿è¡Œ kexec å·¥å…·:

{% highlight bash %}
kexec -p <Dump-capture-kernel> --initrd=<initrd-for-Dump-capture-kernel> \
      --append=<CMDLINE>
{% endhighlight %}

![](https://gitee.com/BiscuitOS_team/PictureSet/raw/Gitee/HK/TH000636.png)

å½“åœ¨ç³»ç»Ÿä¸­æˆåŠŸè¿è¡Œ kexec ä¸­ï¼Œæ¥ç€å¯ä»¥æ‰‹åŠ¨è§¦å‘å†…æ ¸ panicï¼Œä»¥æ­¤æŸ¥çœ‹åŠŸèƒ½çš„å®Œæˆæ€§:

{% highlight bash %}
echo c > /proc/sysrq-trigger
{% endhighlight %}

å½“ä½¿ç”¨è¯¥å‘½ä»¤ä¹‹åï¼Œå†…æ ¸å°†è§¦å‘ panicï¼Œæ­£å¸¸æƒ…å†µä¸‹å†…æ ¸å°†å¡ä¸»ä¸è¿è¡Œï¼Œå½“æ­¤æ—¶ kexec ä¼š>è¿…é€Ÿé‡å¯ä¸€ä¸ªæ–°çš„å†…æ ¸ï¼Œå¹¶ä¿æŠ¤äº†å‘ç”Ÿ panic çš„ç°åœºï¼Œå³å†…æ ¸çš„ kdumpã€‚åœ¨è¿›å…¥æ–°ç³»ç»Ÿä¹‹åï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤è·å¾—å‘ç”Ÿ panic æ—¶çš„ vmcore:

{% highlight bash %}
cp /proc/vmcore <Dump-file>
{% endhighlight %}

"/proc/vmcore" åŒ…å«äº† kdump çš„å†…å®¹ï¼Œå¯ä»¥å°† kdump çš„å†…å®¹æ‹·è´åˆ° BiscuitOS çš„ä¸€ä¸ªç£ç›˜ä¸Šï¼Œä»¥ä¾¿åæœŸä½¿ç”¨ crash è¿›è¡Œé—®é¢˜åˆ†ææ’é™¤ã€‚

![å¦‚æœå›¾ç‰‡ä¸èƒ½æ­£å¸¸æ˜¾ç¤ºï¼Œè¯·å…ˆåœ¨ç½‘é¡µä¸Šç™»å½• Gitee](https://gitee.com/BiscuitOS_team/PictureSet/raw/Gitee/HK/TH000637.png)

å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå½“å‘ç”Ÿ panic ä¹‹åï¼Œkexec å·¥å…·é‡å¯äº†ä¸€ä¸ªæ–°çš„å†…æ ¸ï¼Œå¹¶åœ¨æ–°å†…æ ¸ä¸Šä¿å­˜äº† kdump çš„å†…å®¹åˆ° "/mnt/Freeze" ç›®å½•ã€‚å½“ kdump å†…å®¹æ‹·è´å®Œæ¯•ä¹‹åï¼Œæ¥ä¸‹æ¥å°±æ˜¯å°† kdump æ–‡ä»¶ä» BiscuitOS ä¸­æ‹·è´åˆ° Host ä¸»æœºä¸­ï¼Œå‚è€ƒå¦‚ä¸‹å‘½ä»¤:

{% highlight bash %}
cd BiscuitOS/output/linux-XXXX/
./RunBiscuitOS.sh mount
cp FreezeDir/kdump ./
./RunBiscuitOS.sh umount
{% endhighlight %}

![](https://gitee.com/BiscuitOS_team/PictureSet/raw/Gitee/HK/TH000639.png)

å½“ä» BiscuitOs çš„ Freeze ç£ç›˜ä¸Šè·å¾—äº† kdump çš„å†…å®¹ä¹‹åï¼Œæ¥ä¸‹æ¥ä½¿ç”¨ crash æ’é™¤é—®é¢˜ï¼Œæ­¤æ—¶éœ€è¦ä½¿ç”¨å¸¦æœ‰ debug-info çš„å†…æ ¸é•œåƒï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨ vmlinuxï¼Œå‚è€ƒå¦‚ä¸‹å‘½ä»¤:

{% highlight bash %}
cd BiscuitOS/output/linux-XXXX/
crash kdump linux/linux/vmlinux
{% endhighlight %}

![](https://gitee.com/BiscuitOS_team/PictureSet/raw/Gitee/HK/TH000640.png)

![](https://gitee.com/BiscuitOS_team/PictureSet/raw/Gitee/BiscuitOS/kernel/IND000100.png)

----------------------------------

<span id="B82"></span>

![](https://gitee.com/BiscuitOS_team/PictureSet/raw/Gitee/BiscuitOS/kernel/IND00000Q.jpg)

#### æ ‡å‡†å‘è¡Œç‰ˆæ–¹æ¡ˆ (RedHat/Ubuntu)

ç›¸å¯¹äºé€šç”¨æ–¹æ¡ˆå’Œ BiscuitOS æ–¹æ¡ˆï¼Œåœ¨æ ‡å‡†å‘è¡Œç‰ˆ RedHat æˆ–è€… Ubuntu ä¸­å·²ç»é›†æˆäº†å®Œæ•´çš„å¼€å‘å·¥å…·é“¾ï¼Œå› æ­¤å¼€å‘è€…å¯ä»¥å°†å…³æ³¨åŠ›æ”¾åœ¨åˆ†æå†…æ ¸æ ¸å¿ƒè½¬å‚¨æœ¬èº«ã€‚ç”±äºå‘è¡Œç‰ˆä¸€èˆ¬é‡‡ç”¨ GRUB å¼•å¯¼å†…æ ¸çš„å¯åŠ¨ï¼Œå› æ­¤åœ¨ CMDLINE çš„ä¿®æ”¹ä¸Šä¼šæœ‰å·®å¼‚ï¼Œå¹¶ä¸”ç³»ç»Ÿä¸º kdump æ·»åŠ äº†æœåŠ¡ï¼Œå› æ­¤å¯ä»¥å¯¹æŠ“æ• kdump è¿‡ç¨‹è¿›è¡Œå®šåˆ¶åŒ–é…ç½®ã€‚å½“ç³»ç»Ÿå‘ç”Ÿå†…æ ¸è½¬å‚¨çš„æ—¶å€™ï¼Œç³»ç»Ÿå¯ä»¥å°† kdump æ–‡ä»¶ä¿å­˜åœ¨é…ç½®ä¹‹åçš„ä½ç½®. é‚£ä¹ˆæ¥ä¸‹æ¥ä»¥ Ubuntu ä¸ºä¾‹è¿›è¡Œè®²è§£:

> - [å‘è¡Œç‰ˆå†…æ ¸æ ¸å¿ƒè½¬å‚¨ kdump å†…æ ¸é…ç½®](#BX2)
>
> - [å‘è¡Œç‰ˆå†…æ ¸æ ¸å¿ƒè½¬å‚¨ kdump CRUB CMDLINE é…ç½®](#B06)
>
> - [Kdump å·¥å…·é“¾å®‰è£…](#B05)
>
> - [å‘è¡Œç‰ˆå†…æ ¸æ ¸å¿ƒè½¬å‚¨ kdump æŠ“æ•è¿‡ç¨‹](#C2)

![](https://gitee.com/BiscuitOS_team/PictureSet/raw/Gitee/BiscuitOS/kernel/IND000100.png)

------------------------------------------

###### <span id="BX2">BiscuitOS å†…æ ¸è½¬å‚¨ Kdump å†…æ ¸é…ç½®</span>

å†…æ ¸ä¸ºäº†æ”¯æŒ kdump åŠŸèƒ½ï¼Œéœ€è¦æ‰“å¼€ä»¥ä¸‹å®, åœ¨æ ‡å‡†å‘æ–°ç‰ˆä¸­å¯ä»¥æŒ‰å¦‚ä¸‹æ–¹æ³•ç¡®è®¤å®æ˜¯å¦æ‰“å¼€ï¼Œå¦‚æœæ²¡æœ‰æ‰“å¼€ï¼Œéœ€è¦é‡æ–°ç¼–è¯‘å‘è¡Œç‰ˆçš„å†…æ ¸:

{% highlight bash %}
cat /boot/config-$(uname -r) | grep <MACRO>
{% endhighlight %}

![](https://gitee.com/BiscuitOS_team/PictureSet/raw/Gitee/HK/TH000641.png)

###### CONFIG_KEXEC

![](https://gitee.com/BiscuitOS_team/PictureSet/raw/Gitee/HK/TH000630.png)

###### CONFIG_SYSFS

![](https://gitee.com/BiscuitOS_team/PictureSet/raw/Gitee/HK/TH000631.png)

###### CONFIG_DEBUG_INFO

![](https://gitee.com/BiscuitOS_team/PictureSet/raw/Gitee/HK/TH000632.png)

###### CONFIG_CRASH_DUMP

![](https://gitee.com/BiscuitOS_team/PictureSet/raw/Gitee/HK/TH000633.png)

###### CONFIG_PROC_VMCORE

![](https://gitee.com/BiscuitOS_team/PictureSet/raw/Gitee/HK/TH000634.png)

![](https://gitee.com/BiscuitOS_team/PictureSet/raw/Gitee/BiscuitOS/kernel/IND000100.png)

------------------------------------

###### <span id="B06">å‘è¡Œç‰ˆå†…æ ¸æ ¸å¿ƒè½¬å‚¨ kdump CRUB CMDLINE é…ç½®</span>

ä¸ºäº†æ”¯æŒ kdump éœ€è¦åœ¨å†…æ ¸çš„ CMDLINE ä¸­æ·»åŠ  crashkernel å­—æ®µï¼Œè¯¥å­—æ®µçš„è¯­æ³•å¦‚ä¸‹:

{% highlight bash %}
crashkernel=<range1>:<size1>[,<range2>:<size2>,...][@offset]
range=start-[end]
{% endhighlight %}

æ ‡å‡†å‘è¡Œç‰ˆçš„ CMDLINE ä½äº GRUB ä¸­ï¼Œå› æ­¤å¯ä»¥å‚è€ƒå¦‚ä¸‹è¿›è¡Œæ·»åŠ :

{% highlight bash %}
vi /etc/default/grub

GRUB_TIMEOUT=5
GRUB_DEFAULT=saved
GRUB_DISABLE_SUBMENU=true
GRUB_TERMINAL_OUTPUT="console"
GRUB_CMDLINE_LINUX="crashkernel=128M rd.lvm.lv=centos/root rd.lvm.lv=centos/swap rhgb quiet"
GRUB_DISABLE_RECOVERY="true"
{% endhighlight %}

![](https://gitee.com/BiscuitOS_team/PictureSet/raw/Gitee/HK/TH000642.png)

åœ¨ GRUB_CMDLINE_LINUX å˜é‡ä¸­ä¿®æ”¹ crashkernel çš„å¤§å°ï¼Œä¾‹å¦‚ç³»ç»Ÿç‰©ç†å†…å­˜ 512Mï¼Œé‚£ä¹ˆä¿ç•™ 256M ç»™ kdump. æ³¨æ„é¢„ç•™å†…å­˜è¿‡å°ä¼šå¯¼è‡´ç”Ÿæˆçš„ coredump æ–‡ä»¶å¤±è´¥ (ä¸çŸ¥é“è®¾ç½®å¤šå°‘æ—¶ï¼Œå¯ä»¥å°è¯•æ¯æ¬¡å¢åŠ  128M), ä¿®æ”¹åè¿˜éœ€é‡å¯ grub é…ç½®æ–‡ä»¶ï¼Œé‡å¯ç³»ç»Ÿæ‰ç”Ÿæ•ˆ:

{% highlight bash %}
grub2-mkconfig -o /boot/grub/grub.cfg
reboot
{% endhighlight %}

![](https://gitee.com/BiscuitOS_team/PictureSet/raw/Gitee/HK/TH000643.png)

![](https://gitee.com/BiscuitOS_team/PictureSet/raw/Gitee/BiscuitOS/kernel/IND000100.png)

------------------------------------------

#### <span id="B05">Kdump å·¥å…·é“¾å®‰è£…</span>

åœ¨è°ƒè¯•è¿‡ç¨‹ä¸­ï¼Œç»å¸¸éœ€è¦é‡å¯å†…æ ¸ä»¥è¿˜åŸç°åœºï¼Œè¿›è€Œå¤ç°æŸäº›é—®é¢˜äºˆä»¥è¿½è¸ªè§£å†³. ç”±äºæ¯ä¸€
æ¬¡çš„å†…æ ¸å¯åŠ¨ï¼Œéƒ½ä¼šä¼´éšç€ä¸€æ¬¡çš„ boot è‡ªæ£€. ä½†æ˜¯ï¼Œå¯¹äºå·²ç»å¯åŠ¨è¿‡çš„åŒä¸€å†…æ ¸ï¼Œé‡å¤çš„
 boot è‡ªæ£€å®Œå…¨æ²¡æœ‰å¿…è¦ï¼Œä¸”é€ æˆäº†èµ„æºæµªè´¹. æ­¤å¤–ï¼Œæœ‰æ—¶å€™éœ€è¦ä½¿ç”¨ä¸€ä¸ªå°å†…æ ¸æ¥å¯åŠ¨ä¸€
ä¸ªå¤§å†…æ ¸. åœ¨è¿™ä¸¤ç§éœ€æ±‚ä¸‹ï¼Œkexec åº”è¿è€Œç”Ÿï¼Œkexec æ˜¯ä¸€æ¬¾å¯ä»¥è®©æ‚¨é‡æ–°å¯åŠ¨åˆ°ä¸€ä¸ªæ–° Linux å†…æ ¸çš„å¿«é€Ÿé‡æ–°å¼•å¯¼åŠŸèƒ½éƒ¨ä»¶ï¼Œä¸å†å¿…é¡»é€šè¿‡å›ºä»¶å’Œå¼•å¯¼è£…è½½ç¨‹åºé˜¶æ®µï¼Œä»è€Œè·³è¿‡åº>åˆ—ä¸­æœ€é•¿çš„éƒ¨åˆ†ï¼Œå¤§å¤§å‡å°‘äº†é‡å¯æ—¶é—´. å¯¹ä¼ä¸šçº§ç³»ç»Ÿè€Œè¨€ï¼ŒKexec å¤§å¤§å‡å°‘äº†é‡å¯å¼•èµ·çš„
ç³»ç»Ÿå®•æœºæ—¶é—´. å¯¹å†…æ ¸å’Œç³»ç»Ÿè½¯ä»¶å¼€å‘è€…è€Œè¨€ï¼ŒKexec å¸®åŠ©æ‚¨åœ¨å¼€å‘å’Œæµ‹è¯•æˆæœæ—¶å¯ä»¥è¿…é€Ÿ
é‡æ–°å¯åŠ¨ç³»ç»Ÿï¼Œè€Œä¸å¿…æ¯æ¬¡éƒ½è¦å†ç»å†è€—æ—¶çš„å›ºä»¶é˜¶æ®µ. ä¸»æµçš„ RedHat å’Œ Ubuntu å·¥å…·éƒ¨ç½²å¯ä»¥å‚è€ƒå¦‚ä¸‹å‘½ä»¤:

{% highlight bash %}
on RedHat:
  sudo yum install -y kexec-tools
  sudo yum install -y crash

on Ubuntu:
  sudo apt install -y kdump-tools
  sudo apt install -y crash
  sudo apt install -y kexec-tools
  sudo apt install -y makedumpfile
  sudo apt install -y linux-crashdump
{% endhighlight %}

![](https://gitee.com/BiscuitOS_team/PictureSet/raw/Gitee/HK/TH000644.png)

ä¿®æ”¹ kdump é»˜è®¤é…ç½® /etc/kdump.conf, CentOS é»˜è®¤å®‰è£… kdumpï¼Œæ ¹æ®éœ€è¦ä¿®æ”¹é»˜è®¤é…ç½®
:

{% highlight bash %}
vi /etc/kdump.conf

#æŒ‡å®š coredump æ–‡ä»¶å­˜å‚¨ä½ç½®
path /var/crash
#å¢åŠ -cå‚æ•°ï¼Œä»£è¡¨å‹ç¼© coredump æ–‡ä»¶
core_collector makedumpfile -c -l --message-level 1 -d 31
#ç”Ÿæˆcoredumpåï¼Œé‡å¯ç³»ç»Ÿï¼Œ
default reboot
{% endhighlight %}

![](https://gitee.com/BiscuitOS_team/PictureSet/raw/Gitee/BiscuitOS/kernel/IND000100.png)

------------------------------------------

-----------------------------------------------

#### <span id="Z0">é™„å½•</span>

> [BiscuitOS Home](https://biscuitos.github.io/)
>
> [BiscuitOS Blog 2.0](https://biscuitos.github.io/blog/BiscuitOS_Catalogue/)
>
> [Linux Kernel](https://www.kernel.org/)
>
> [Bootlin: Elixir Cross Referencer](https://elixir.bootlin.com/linux/latest/source)
>

#### æèµ ä¸€ä¸‹å§ ğŸ™‚

![MMU](https://gitee.com/BiscuitOS_team/PictureSet/raw/Gitee/BiscuitOS/kernel/HAB000036.jpg)
