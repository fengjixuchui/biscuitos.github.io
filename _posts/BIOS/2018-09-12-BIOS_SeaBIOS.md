---
layout: post
title:  "BiscuitOS è¿è¡Œå¹¶è°ƒè¯• SeaBIOS"
date:   2018-09-12 22:53:30 +0800
categories: [BIOS]
excerpt: BiscuitOS è¿è¡Œå¹¶è°ƒè¯• SeaBIOS.
tags:
  - BIOS
  - SeaBIOS
---

## ç®€ä»‹

SeaBIOS æ˜¯å¼€æº 16bit Intel X86 BIOS é¡¹ç›®ï¼Œéµå¾ªæ ‡å‡† BIOS è°ƒç”¨æ¥å£ï¼ŒSeaBIOS 
èƒ½å¤Ÿè¿è¡Œåœ¨ç¡¬ä»¶æ¨¡æ‹Ÿå™¨æˆ–åŸç”Ÿçš„ X86 ç¡¬ä»¶ä¸Šã€‚

## åŸºç¡€åŸç†

BIOS ç¨‹åºæ˜¯è®¡ç®—æœºä¸Šç”µåï¼ŒCPU ç¬¬ä¸€ä¸ªå¼€å§‹è¿è¡Œçš„ç¨‹åºï¼Œå®Œå…¨è¿è¡Œåœ¨è£¸æœºä¸Šï¼Œç”¨äºå®Œ
æˆå¯¹ç³»ç»Ÿç¡¬ä»¶çš„åˆå§‹åŒ–ï¼Œå¹¶ä¸”ä¸ºé©±åŠ¨ OS åšå¥½å‡†å¤‡ã€‚BIOS ç¨‹åºæ ¹æ®å…·ä½“çš„ç¡¬ä»¶å…·æœ‰å¾ˆ
é«˜çš„è€¦åˆåº¦ï¼ŒåŸºæœ¬ä¸Šä¸åŒçš„ç¡¬ä»¶æ¶æ„éƒ½ä¼šå¯¹åº”ä¸åŒçš„ BIOS ç¨‹åºï¼Œæ‰€ä»¥ä¸€èˆ¬è®¡ç®—æœºç”Ÿäº§
å•†éƒ½ä¼šè‡ªå·±å¼€å‘ BIOS ç¨‹åºï¼Œè™½ç„¶å¯èƒ½æœ‰å¾ˆå¤šéƒ¨åˆ†æ˜¯å¯ä»¥å…±ç”¨çš„ï¼Œä½†æ˜¯æ¯ä¸ªå‚å•†è®¾è®¡çš„
è®¡ç®—æœºç¡¬ä»¶æ¶æ„éƒ½ä¼šæœ‰åŒºåˆ«ï¼Œæ‰€ä»¥è¿˜æ˜¯æœ‰ä¸€éƒ¨åˆ†éœ€è¦è‡ªå·±å®šåˆ¶ã€‚SeaBIOS è™½ç„¶è¿è¡Œåœ¨æ¨¡
æ‹Ÿå™¨ä¸Šï¼Œä½†æ˜¯ä¹Ÿæœ‰è‡ªå·±é€‚é…çš„ä¸€å¥—ç¡¬ä»¶æ¶æ„ï¼Œç†è§£ SeaBIOS é€‚é…çš„ç¡¬ä»¶æ¶æ„å¯¹äºç†è§£ 
SeaBIOS çš„ä»£ç æœ‰å¾ˆé‡è¦çš„ä½œç”¨ã€‚

SeaBIOS ä¹Ÿåƒæ­£å¸¸çš„ BIOS ä¸€æ ·ï¼Œåœ¨è™šæ‹Ÿæœºä¸Šç”µçš„æ—¶å€™ï¼Œä¼šè¢«åŠ è½½åˆ°åœ°å€ç©ºé—´çš„ 
0xFFFFFFF0 å¤„ï¼Œå¹¶ä¸”è¯¥å¤„æ˜¯ä¸€æ¡è·³è½¬æŒ‡ä»¤ï¼Œè·³è½¬å»æ‰§è¡Œ SeaBIOS çš„ä»£ç ï¼Œå®Œæˆç¡¬ä»¶çš„
åˆå§‹åŒ–ï¼Œä¸­æ–­æœåŠ¡å‡½æ•°çš„è®¾ç½®ï¼ŒACPI è¡¨ï¼ŒSMBIOS è¡¨ç­‰çš„åˆ›å»ºï¼Œæœ€åå¼•å¯¼å¯åŠ¨ OSã€‚

SeaBIOS å’Œæ­£å¸¸ BIOS çš„åŒºåˆ«åœ¨äºå…¶è¿è¡Œçš„ç¯å¢ƒæ˜¯ä¸€ä¸ªç”± Hypervisor æ¨¡æ‹Ÿå‡ºæ¥çš„ç¯å¢ƒï¼Œ
æœ‰å¾ˆå¤šåœ°æ–¹å¯ä»¥ç®€åŒ–ï¼Œä¸»è¦è¡¨ç°ä¸ºï¼š

è™šæ‹ŸåŒ–ç¯å¢ƒä¸­å¯¹ç¡¬ä»¶è®¾å¤‡è¿›è¡Œæ¨¡æ‹Ÿçš„å¯¹è±¡æ˜¯ç¡¬ä»¶è®¾å¤‡çš„åŠŸèƒ½åŠå¯¹å¤–çš„æ¥å£ï¼Œå¹¶ä¸éœ€è¦å»
æ¨¡æ‹Ÿç¡¬ä»¶è®¾å¤‡çš„å†…éƒ¨è¿è¡Œæœºåˆ¶å’Œè®¾å¤‡çš„ç‰©ç†ç‰¹æ€§ï¼Œæ‰€ä»¥å°±å¯ä»¥å¤§å¤§ç®€åŒ–ä¸€äº›æ¨¡æ‹Ÿè®¾å¤‡çš„
é…ç½®å’Œåˆå§‹åŒ–ï¼Œå…¶ä¸­åŒ…æ‹¬ï¼š

> èŠ¯ç‰‡é…ç½®ä¸Šï¼Œä¼ ç»Ÿçš„ BIOS éœ€è¦å¯¹ä¸»æ¿ä¸Šçš„å„ä¸ªèŠ¯ç‰‡ï¼Œå¦‚ CPUã€å—æ¡¥èŠ¯ç‰‡ã€åŒ—æ¡¥èŠ¯ç‰‡
> ç­‰è¿›è¡Œå„ç§é…ç½®ï¼Œè®©å…¶èƒ½å¤Ÿæ­£å¸¸è¿è¡Œèµ·æ¥ã€‚è€Œåœ¨è™šæ‹ŸåŒ–ç¯å¢ƒä¸­ï¼Œè¿™äº›ç‰©ç†èŠ¯ç‰‡ä¸€èˆ¬éƒ½
> æ˜¯ä¸å­˜åœ¨çš„ï¼Œæ‰€ä»¥é‚£äº›æ¶‰åŠåˆ°èŠ¯ç‰‡å†…éƒ¨è¿è¡Œæœºåˆ¶ã€èŠ¯ç‰‡ç‰©ç†ç‰¹æ€§çš„é…ç½®éƒ½å°†ä¸å†éœ€è¦ï¼Œ
> SeaBIOS åªéœ€è¦å…³æ³¨å’ŒèŠ¯ç‰‡åŠŸèƒ½ç›¸å…³çš„é…ç½®å³å¯ã€‚

> å†…å­˜é…ç½®ä¸Šï¼Œä¼ ç»Ÿçš„BIOSéƒ½ä¼šåŒ…å« MRC ä»£ç ï¼ˆå†…å­˜å‚å•†æä¾›ï¼‰ç”¨äºå¯¹å†…å­˜è¿›è¡Œåˆå§‹
> åŒ–ï¼Œä½†æ˜¯åœ¨è™šæ‹ŸåŒ–ç¯å¢ƒä¸­ï¼Œå†…å­˜å·²ç»å®Œå…¨é…ç½®å¥½äº†ï¼Œæ‰€ä»¥ SeaBIOS é‡Œé¢æ ¹æœ¬æ‰¾ä¸åˆ°
> å†…å­˜åˆå§‹åŒ–çš„ä»£ç ï¼Œæœ€å¤šåªæ˜¯å¯¹ e820 è¡¨è¿›è¡Œé…ç½®ï¼Œæˆ–å¯¹å†…å­˜çš„å±æ€§è¿›è¡Œæ›´æ”¹ã€‚

> æ€»çº¿é…ç½®ä¸Šï¼Œè®¡ç®—æœºä¸Šçš„æ€»çº¿ï¼Œç‰¹åˆ«æ˜¯ä¸€äº›è¾ƒé«˜é€Ÿçš„æ€»çº¿å¦‚ PCIï¼ŒDMIï¼ŒPCIeï¼ŒQPI 
> ä¹‹ç±»çš„æ€»çº¿ï¼Œéƒ½ä¼šåˆ†æˆç‰©ç†å±‚ã€é“¾è·¯å±‚ã€ä¼ è¾“å±‚ç­‰å¤šå±‚ç»“æ„ï¼Œä¸ºäº†è®©ç‰©ç†æ€»çº¿èƒ½å¤Ÿæ­£
> å¸¸è¿è¡Œèµ·æ¥ï¼Œä¼ ç»Ÿçš„ BIOS éƒ½éœ€è¦å¯¹è¿™äº›æ€»çº¿å„ä¸ªå±‚çš„å¯„å­˜å™¨è¿›è¡Œé…ç½®ï¼Œå¯¹æ€»çº¿çš„è¿
> è¡Œæ¨¡å¼ã€è¿è¡Œé€Ÿç‡ç­‰å‚æ•°è¿›è¡Œè°ƒæ•´ã€è®­ç»ƒï¼ˆtrainingï¼‰ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ä¸ªæ¯”è¾ƒè€—æ—¶çš„æ“
> ä½œã€‚ä½†æ˜¯åœ¨è™šæ‹ŸåŒ–ç¯å¢ƒä¸­ï¼Œè¿™äº›æ€»çº¿ç‰©ç†ç‰¹æ€§ä¸Šçš„é…ç½®å’Œåˆå§‹åŒ–éƒ½å¯ä»¥çœå»ï¼Œå› ä¸ºå¹¶
> æ²¡æœ‰çœŸæ­£çš„ç‰©ç†æ€»çº¿å­˜åœ¨ï¼ŒSeaBIOS è¦åšçš„å°±æ˜¯å¯¹è¿™äº›æ€»çº¿åœ¨è½¯ä»¶å±‚é¢ä¸Šçš„æ¥å£è¿›è¡Œ
> é…ç½®ï¼Œå¦‚ PCI æ€»çº¿çš„é…ç½®ç©ºé—´

ä» SeaBIOS æä¾›ç»™ OS çš„å„ç§ä¿¡æ¯è¡¨ä¸Šçœ‹ï¼Œå¦‚ APCI è¡¨ã€SMBIOS è¡¨ã€E820 è¡¨ç­‰ï¼Œä¼ 
ç»Ÿçš„BIOS åŸºæœ¬ä¸Šéƒ½å¾—é è‡ªå·±å»æ¢ç´¢ç³»ç»Ÿçš„æ‰€æœ‰ä¿¡æ¯é€æ­¥å»ºç«‹è¿™äº›ä¿¡æ¯è¡¨ï¼Œè¿™å¯èƒ½æ˜¯ä¸€
ä¸ªæ¯”è¾ƒæ¼«é•¿çš„è¿‡ç¨‹ã€‚è€Œåœ¨è™šæ‹ŸåŒ–ç¯å¢ƒä¸­ï¼Œè¿™äº›è¡¨å¾ˆå¤šå¹¶ä¸éœ€è¦ SeaBIOS è‡ªå·±å»é€æ­¥å»º
ç«‹ï¼Œå¾ˆå¤šå¯ä»¥æ˜¯Hypervisor å°±å¯ä»¥é€šè¿‡ç‰¹å®šçš„æ–¹å¼å°†è¿™äº›è¡¨ä¼ ç»™ SeaBIOSï¼ŒSeaBIOS 
åªéœ€è¦åœ¨æœ‰å¿…è¦çš„æ—¶å€™å¯¹è¿™äº›è¡¨çš„æŸäº›ä¿¡æ¯è¿›è¡Œæ›´æ–°ã€‚

æ‰€ä»¥ï¼Œæ€»çš„æ¥è¯´ï¼Œå¯ä»¥å°† SeaBIOS çœ‹æˆç®€åŒ–ç‰ˆçš„ BIOSï¼Œä¸»è¦ä»ä¸Šé¢è¯´çš„å‡ ä¸ªæ–¹é¢è¿›
è¡Œäº†ç®€åŒ–ã€‚

## å®è·µ SeaBIOS

#### æ­å»ºå¼€å‘ç¯å¢ƒ

BiscuitOS æœ€æ–°ç‰ˆæœ¬å·²ç»æ”¯æŒæºç ç¼–è¯‘ SeaBIOSï¼Œå¹¶å¯ä»¥ä½¿ç”¨ç¼–è¯‘ç”Ÿæˆçš„ BIOS å¯åŠ¨ 
Linuxã€‚å¼€å‘è€…å¯ä»¥æŒ‰ç…§å¦‚ä¸‹æ­¥éª¤åœ¨ BiscuitOS ä¸Šè¿è¡Œ SeaBIOSã€‚

é¦–å…ˆåˆ¶ä½œæ­å»º BiscuitOS ç³»ç»Ÿï¼Œè¯·å‚è€ƒå¦‚ä¸‹æ–‡æ¡£ï¼š

> [åˆ¶ä½œåŸºäº Linux 1.0.1.2 å†…æ ¸ BiscuitOS](/blog/Linux-1.0.1.2-Usermanual/)

æ­å»ºå®Œä¹‹åï¼Œè¯·å®‰è£…å¿…è¦çš„å¼€å‘å·¥å…·ï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š

{% highlight ruby %}
sudo apt-get install iasl
{% endhighlight %}

#### ç¼–è¯‘ SeaBIOS

å‡†å¤‡å¥½å¼€å‘ç¯å¢ƒä¹‹åï¼Œå¼€å‘è€…é…ç½® BiscuitOSï¼Œ ä»¥æ­¤æ”¯æŒ SeaBIOSï¼ŒæŒ‰å¦‚ä¸‹æ­¥éª¤ï¼š

é¦–å…ˆï¼Œåœ¨ä¸­ç«¯ä¸­è¾“å…¥å¦‚ä¸‹å‘½ä»¤

{% highlight ruby %}
cd BiscuitOS/
make linux_1.0.1.2_defconfig
make
{% endhighlight %}

ç¬¬ä¸€æ¬¡ä½¿ç”¨ SeaBIOSï¼Œç¼–è¯‘ç³»ç»Ÿä¼šä» SeaBIOS çš„å®˜ç½‘ä¸‹è½½æºç ï¼Œæ ¹æ®å¼€å‘è€…çš„ç½‘ç»œ
ç¯å¢ƒä¼šèŠ±è´¹ä¸åŒçš„æ—¶é—´ã€‚ä¸‹è½½å®Œæºç ä¹‹åï¼Œç¼–è¯‘ç³»ç»Ÿä¼šç¼–è¯‘ SeaBIOS å¹¶å°†ç¼–è¯‘ç”Ÿæˆ
çš„ SeaBIOS å®‰è£…åˆ°æŒ‡å®šçš„ Linux æºç ç›®å½•ã€‚åœ¨æœ¬ä¾‹å­ä¸­ï¼ŒSeaBIOS æºç ç¼–è¯‘ç”Ÿæˆçš„
é•œåƒ SeaBIOS.bin ä¼šè¢«å®‰è£…åˆ°å¦‚ä¸‹ç›®å½•ï¼š

{% highlight ruby %}
BiscuitOS/output/linux_1.0.1.2-ext2/BIOS/SeaBIOS.bin
{% endhighlight %}

#### è¿è¡Œ SeaBIOS

ç¼–è¯‘å®Œä¹‹åï¼Œå¼€å‘è€…å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤è¿è¡Œ SeaBIOSï¼Œ

{% highlight ruby %}
cd BiscuitOS/output/linux_1.0.1.2-ext2/linux/linux/
make start
{% endhighlight %}

è¿è¡Œå¦‚ä¸‹å›¾ï¼ŒSeaBIOS åœ¨ä¸­ç«¯ä¸­è¾“å‡º BiscuitOS logo

![Menuconfig8](/assets/PDB/BiscuitOS/kernel/BIOS000006.png)

#### ä¿®æ”¹ SeaBIOS æºç 

BiscuitOS çš„ç¼–è¯‘ä½“åˆ¶ç±»ä¼¼äº Buildrootï¼Œæ‰€ä»¥å¼€å‘è€…è¦ä¿®æ”¹ SeaBIOS æºç å¿…é¡»æŒ‰
ç…§å¦‚ä¸‹æ­¥éª¤ã€‚ä¾‹å¦‚æœ¬ä¾‹ä¸­ï¼ŒSeaBIOS çš„ç‰ˆæœ¬ä¸º rel-1.9.3ï¼Œå…¶æºç ä½äº

{% highlight ruby %}
BiscuitOS/output/linux_1.0.1.2-ext2/BIOS/SeaBIOS_rel-1.9.3
{% endhighlight %}

å¼€å‘è€…å¯ä»¥åœ¨æ­¤ç›®å½•ä¸‹ä¿®æ”¹ä»»æ„ä»£ç ï¼Œä¿®æ”¹å®Œä¹‹åï¼Œè¯·å‚ç…§å¦‚ä¸‹å‘½ä»¤ç”Ÿæˆè¡¥ä¸(æœ¬ä¾‹å­
ä»¥ SeaBIOS rel-1.9.3 ä½œä»‹ç»ï¼Œå…¶ä»–ç‰ˆæœ¬ç…§æ ·)

{% highlight ruby %}
cd BiscuitOS/output/linux_1.0.1.2-ext2/BIOS/SeaBIOS_rel-1.9.3
git status
git add ï¼ˆæ·»åŠ ä½ ä¿®æ”¹çš„æ–‡ä»¶ï¼‰
git commit -m "(æ·»åŠ ä½ çš„ä¿®æ”¹æ³¨é‡Š)"
git format-patch -n rel-1.9.3
mv 0*.patch  */BiscuitOS/boot/i386/SeaBIOS/patch/rel-1.9.3
cd  BiscuitOS/
make clean
make
{% endhighlight %}

æŒ‰ç…§ä¸Šé¢çš„ä¿®æ”¹ï¼Œç¼–è¯‘ä¹‹åï¼Œæ–°çš„ SeaBIOS.bin å°†åŒ…å«ä½ çš„ä¿®æ”¹ï¼Œå‚ç…§ä¸Šä¸€èŠ‚è¿›è¡Œ 
SeaBIOS çš„è¿è¡Œã€‚

### é™„å½• A

SeaBIOS æ”¯æŒç‰ˆæœ¬å·ï¼š

{% highlight ruby %}
rel-0.1.0
rel-0.1.1
rel-0.1.2
rel-0.1.3
rel-0.2.0
rel-0.2.1
rel-0.2.2
rel-0.2.3
rel-0.3.0
rel-0.4.0
rel-0.4.1
rel-0.4.2
rel-0.5.0
rel-0.5.1
rel-0.6.0
rel-0.6.1
rel-0.6.1.1
rel-0.6.1.2
rel-0.6.1.3
rel-0.6.2
rel-1.10.0
rel-1.10.1
rel-1.10.2
rel-1.10.3
rel-1.11.0
rel-1.11.1
rel-1.11.2
rel-1.6.3
rel-1.6.3.1
rel-1.6.3.2
rel-1.7.0
rel-1.7.1
rel-1.7.2
rel-1.7.2.1
rel-1.7.2.2
rel-1.7.3
rel-1.7.3.1
rel-1.7.3.2
rel-1.7.4
rel-1.7.5
rel-1.7.5-rc1
rel-1.7.5.1
rel-1.7.5.2
rel-1.8.0
rel-1.8.1
rel-1.8.2
rel-1.9.0
rel-1.9.1
rel-1.9.2
rel-1.9.3
{% endhighlight %}

### é™„å½• B

> [SeaBIOS ä»‹ç»](https://blog.csdn.net/lindahui2008/article/details/80948396)
>
> [SeaBIOS](https://www.coreboot.org/SeaBIOS)
>
> [BiscuitOS](/blog/HomePage/)

> [BiscuitOS Home](https://biscuitos.github.io/)
>
> [BiscuitOS Driver](/blog/BiscuitOS_Catalogue/)
>
> [BiscuitOS Kernel Build](/blog/Kernel_Build/)
>
> [Linux Kernel](https://www.kernel.org/)
>
> [Bootlin: Elixir Cross Referencer](https://elixir.bootlin.com/linux/latest/sou
rce)

## èµèµä¸€ä¸‹å§ ğŸ™‚

![MMU](/assets/PDB/BiscuitOS/kernel/HAB000036.jpg)
